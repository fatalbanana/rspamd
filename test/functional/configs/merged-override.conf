emails {
  "whitelist" = [
    "rspamd-test.com"
  ]
  rules {
    "RSPAMD_EMAILBL_FULL" {
        dnsbl = "test5.uribl";
        replyto = true;
        }
      "RSPAMD_EMAILBL_DOMAINONLY" {
        dnsbl = "test6.uribl";
        domain_only = true;
        replyto = true;
      }
  }
}

rbl {
  rbls {
    fake {
      from = true;
      ipv4 = true;
      ipv6 = true;
      rbl = "fake.rbl";
      symbol = "FAKE_RBL_UNKNOWN";
      received = true;
      symbols_prefixes = {
        received = 'FAKE_RECEIVED_RBL',
        from = 'FAKE_RBL',
      }
      unknown = true;
      returncodes = {
        "CODE_2" = "127.0.0.2";
        "CODE_3" = "127.0.0.3";
      }
    }
    fake_whitelist {
      from = true;
      ipv4 = true;
      ipv6 = true;
      received = true;
      is_whitelist = true;
      rbl = "fake.wl";
      symbol = "FAKE_WL_RBL_UNKNOWN";
      unknown = true;
      returncodes = {
        "FAKE_WL_RBL_CODE_2" = "127.0.0.2";
        "FAKE_WL_RBL_CODE_3" = "127.0.0.3";
      }
    }
    RSPAMD_EMAILBL {
      rbl = "test8.uribl";
      url_compose_map = "{= env.TESTDIR =}/configs/maps/url_compose_map_for_mails.list";
      ignore_defaults = true;
      emails = true;
      emails_domainonly = true
      returncodes = {
        RSPAMD_EMAILBL = "127.0.0.2";
      }
    }
    URIBL_NOCONTENT {
      rbl = "test9.uribl";
      ignore_defaults = true;
      urls = true;
    }
    URIBL_WITHCONTENT {
      rbl = "test9.uribl";
      ignore_defaults = true;
      urls = true;
      content_urls = true;
    }
    URIBL_CONTENTONLY {
      rbl = "test9.uribl";
      ignore_defaults = true;
      content_urls = true;
      no_ip = true;
    }
    RBL_SELECTOR_SINGLE {
      rbl = "test9.uribl";
      ignore_defaults = true;
      selector = "helo()";
    }
    RBL_SELECTOR_MULTIPLE {
      rbl = "test9.uribl";
      ignore_defaults = true;
      selector = {
        sel_from = "from('smtp'):domain";
        sel_helo = "helo()";
      }
    }
  }
}

surbl {
    "whitelist" = [
    "rspamd-test.com"
  ];
  rules {
    "RSPAMD_URIBL" {
      suffix = "test.uribl";
      check_dkim = true;
      check_emails = true;
      images = false;
      process_script =<<EOD
function(url, suffix)
  local cr = require "rspamd_cryptobox_hash"
  local h = cr.create(url):base32():sub(1, 32)
  return string.format("%s.%s", h, suffix)
end
EOD;
    }
    "DBL" {
      suffix = "test2.uribl";
      no_ip = true;
      check_emails = true;
      check_dkim = true;
      ips = {
        # spam domain
        DBL_SPAM = "127.0.1.2";
        # phish domain
        DBL_PHISH = "127.0.1.4";
      }
    }
    "URIBL_MULTI" {
      suffix = "test3.uribl";
      check_dkim = true;
      check_emails = true;
      bits {
        URIBL_BLOCKED = 1;
        URIBL_BLACK = 2;
        URIBL_GREY = 4;
        URIBL_RED = 8;
      }
    }
    "SPAMHAUS_ZEN_URIBL" {
      suffix = "test4.uribl";
      resolve_ip = true;
      check_emails = true;
      ips {
        URIBL_SBL = "127.0.0.2";
        URIBL_SBL_CSS = "127.0.0.3";
        URIBL_XBL = ["127.0.0.4", "127.0.0.5", "127.0.0.6", "127.0.0.7"];
        URIBL_PBL = ["127.0.0.10", "127.0.0.11"];
        URIBL_DROP = "127.0.0.9";
      }
    }
    "RSPAMD_URIBL_IMAGES" {
      suffix = "test.uribl";
      check_dkim = true;
      check_emails = false;
      images = true;
      process_script =<<EOD
  function(url, suffix)
    local cr = require "rspamd_cryptobox_hash"
    local h = cr.create(url):base32():sub(1, 32)
    return string.format("%s.%s", h, suffix)
end
EOD;
    }
    "BAD_SUBDOMAIN" {
      suffix = "test7.uribl";
      url_compose_map = "{= env.TESTDIR =}/configs/maps/url_compose_map.list";
      check_dkim = true;
      check_emails = false;
    }
  }
}
